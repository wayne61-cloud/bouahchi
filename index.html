<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Bouahchi Gor">
    <meta name="theme-color" content="#000000">
    <title>Bouahchi Gor - Fitness Compl√®te</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        html, body {
            width: 100%;
            height: 100%;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', sans-serif;
            background: #000;
            color: #fff;
            overflow: hidden;
            -webkit-user-select: none;
            user-select: none;
            position: fixed;
        }
        body {
            display: flex;
            flex-direction: column;
            padding: max(env(safe-area-inset-top), 8px) max(env(safe-area-inset-right), 8px) max(env(safe-area-inset-bottom), 8px) max(env(safe-area-inset-left), 8px);
        }
        /* HEADER */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 48px;
            background: linear-gradient(180deg, #0a0a0a 0%, #1a1a1a 100%);
            border-bottom: 1px solid #222;
            margin: -8px -8px 0 -8px;
            padding: 8px 12px;
            flex-shrink: 0;
            z-index: 50;
        }
        .header-left, .header-right {
            font-size: 11px;
            color: #ff5252;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .header-title {
            font-weight: 800;
            font-size: 14px;
            letter-spacing: 0.5px;
            flex: 1;
            text-align: center;
        }
        /* CONTAINER */
        .container {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 0;
            -webkit-overflow-scrolling: touch;
            margin-bottom: 56px;
            scroll-behavior: smooth;
        }
        .page {
            display: none;
            width: 100%;
            min-height: 100%;
            padding: 16px 12px 32px 12px;
            animation: fadeIn 0.3s ease-in;
        }
        .page.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        /* TOP NAV & TABS */
        .top-nav, .tabs {
            display: flex;
            gap: 6px;
            margin-bottom: 12px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            padding-bottom: 4px;
            scroll-snap-type: x mandatory;
        }
        .top-nav-btn, .tab-btn {
            padding: 8px 14px;
            border: 1px solid rgba(255, 82, 82, 0.3);
            background: rgba(255, 82, 82, 0.08);
            color: #ffcccc;
            border-radius: 20px;
            font-size: 11px;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            flex-shrink: 0;
            scroll-snap-align: start;
            font-weight: 500;
            -webkit-user-select: none;
            user-select: none;
        }
        .top-nav-btn:active, .tab-btn:active {
            transform: scale(0.95);
        }
        .top-nav-btn.active, .tab-btn.active {
            background: linear-gradient(135deg, #ff1744, #ff5252);
            color: #fff;
            border-color: #ff5252;
            box-shadow: 0 2px 8px rgba(255, 23, 68, 0.3);
        }
        /* LAUNCHER */
        .launcher {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: calc(100vh - 180px);
            padding: 20px 0;
        }
        .launcher-top {
            text-align: center;
        }
        .launcher-time {
            font-size: 48px;
            font-weight: 800;
            color: #ff5252;
            margin-bottom: 4px;
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
        }
        .launcher-date {
            font-size: 12px;
            color: #ff8a80;
            margin-bottom: 20px;
            font-weight: 500;
        }
        .launcher-title {
            font-size: 28px;
            font-weight: 900;
            color: #fff;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        .launcher-subtitle {
            font-size: 13px;
            color: #ffcccc;
            margin-bottom: 24px;
            font-style: italic;
        }
        .launcher-middle {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .launcher-btn {
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 700;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            width: 100%;
            letter-spacing: 0.5px;
            -webkit-user-select: none;
            user-select: none;
        }
        .launcher-btn.primary {
            background: linear-gradient(135deg, #ff1744, #ff5252);
            box-shadow: 0 4px 16px rgba(255, 23, 68, 0.35);
        }
        .launcher-btn.primary:active {
            transform: scale(0.98);
            box-shadow: 0 2px 8px rgba(255, 23, 68, 0.25);
        }
        .launcher-btn.secondary {
            background: rgba(255, 82, 82, 0.12);
            border: 1.5px solid rgba(255, 82, 82, 0.5);
        }
        .launcher-btn.secondary:active {
            background: rgba(255, 82, 82, 0.18);
        }
        .launcher-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 20px;
        }
        .stat {
            padding: 12px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
            border-radius: 10px;
            border: 1px solid rgba(255, 82, 82, 0.2);
            text-align: center;
            font-size: 11px;
            color: #ffcccc;
            font-weight: 500;
        }
        .stat-value {
            font-size: 20px;
            font-weight: 800;
            color: #ff5252;
            margin-top: 4px;
        }
        /* SECTION */
        .section-title {
            font-size: 24px;
            font-weight: 900;
            color: #ff5252;
            margin-bottom: 8px;
            letter-spacing: 0.5px;
        }
        .section-sub {
            font-size: 12px;
            color: #ffcccc;
            margin-bottom: 16px;
            font-weight: 500;
        }
        /* SEARCH */
        .search-box {
            width: 100%;
            padding: 10px 14px;
            background: rgba(255, 255, 255, 0.06);
            border: 1px solid rgba(255, 82, 82, 0.3);
            border-radius: 10px;
            color: #fff;
            font-size: 13px;
            margin-bottom: 12px;
            outline: none;
            transition: all 0.2s;
            cursor: pointer;
        }
        .search-box:focus {
            background: rgba(255, 255, 255, 0.1);
            border-color: #ff5252;
            box-shadow: 0 0 8px rgba(255, 82, 82, 0.2);
        }
        .search-box::placeholder {
            color: #ff8a80;
        }
        /* GRID */
        .grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        /* CARD */
        .card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.04), rgba(255, 255, 255, 0.01));
            border: 1px solid rgba(255, 138, 128, 0.2);
            border-radius: 12px;
            padding: 14px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }
        .card:active {
            transform: scale(0.98);
            border-color: rgba(255, 82, 82, 0.4);
        }
        .card.favorited {
            background: linear-gradient(135deg, rgba(255, 82, 82, 0.15), rgba(255, 82, 82, 0.08));
            border-color: rgba(255, 82, 82, 0.4);
        }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }
        .card-title {
            font-size: 14px;
            font-weight: 700;
            color: #ff8a80;
            flex: 1;
        }
        .card-fav-btn {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            opacity: 0.7;
            transition: all 0.2s;
            padding: 8px;
            margin: -8px -8px -8px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 44px;
            min-height: 44px;
            -webkit-user-select: none;
            user-select: none;
        }
        .card-fav-btn:active {
            opacity: 1;
            transform: scale(1.15);
        }
        .card-fav-btn.active {
            opacity: 1;
            transform: scale(1.2);
        }
        /* RECIPE IMAGE */
        .recipe-image {
            width: 100%;
            height: 200px;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 12px;
            border: 1px solid rgba(255, 138, 128, 0.2);
            background: #1a1a1a;
        }
        .recipe-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        .card-meta {
            font-size: 11px;
            color: #ffcccc;
            margin-bottom: 8px;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        .card-text {
            font-size: 11px;
            color: #ffebee;
            margin-bottom: 8px;
            line-height: 1.5;
        }
        .card-section {
            background: rgba(255, 82, 82, 0.1);
            padding: 8px;
            border-radius: 6px;
            border-left: 2px solid #ff5252;
            margin-bottom: 8px;
        }
        .card-section-title {
            font-size: 11px;
            font-weight: 600;
            color: #ff8a80;
            margin-bottom: 4px;
        }
        .card-section-content {
            font-size: 10.5px;
            color: #ffebee;
            line-height: 1.6;
            white-space: pre-wrap;
            word-break: break-word;
        }
        .video-container {
            width: 100%;
            aspect-ratio: 16 / 9;
            border-radius: 8px;
            overflow: hidden;
            margin-top: 8px;
            border: 1px solid rgba(255, 138, 128, 0.2);
            background: #1a1a1a;
        }
        .video-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        .card-nav {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(255, 138, 128, 0.2);
        }
        .nav-btn-prev, .nav-btn-next {
            flex: 1;
            padding: 10px;
            border: 1px solid rgba(255, 82, 82, 0.5);
            background: rgba(255, 82, 82, 0.1);
            color: #ff5252;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .nav-btn-prev:active, .nav-btn-next:active {
            transform: scale(0.95);
        }
        .nav-btn-prev:disabled, .nav-btn-next:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        /* RELAX CARD */
        .relax-card {
            background: linear-gradient(135deg, rgba(100, 149, 237, 0.15), rgba(65, 105, 225, 0.08));
            border: 1px solid rgba(100, 149, 237, 0.4);
        }
        .relax-card .card-title {
            color: #6495ed;
        }
        /* NOUSHI CARD */
        .noushi-card {
            background: linear-gradient(135deg, rgba(255, 87, 34, 0.15), rgba(255, 152, 0, 0.08));
            border: 1px solid rgba(255, 87, 34, 0.4);
        }
        .noushi-card .card-title {
            color: #ff6e40;
        }
        /* NAV BOTTOM */
        .nav-bottom {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 56px;
            background: linear-gradient(180deg, #0a0a0a 0%, #1a1a1a 100%);
            border-top: 1px solid #222;
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 0 -8px -8px -8px;
            padding-bottom: max(env(safe-area-inset-bottom), 4px);
            z-index: 1000;
        }
        .nav-btn {
            flex: 1;
            height: 48px;
            border: none;
            background: none;
            color: #666;
            font-size: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 3px;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 0;
            -webkit-user-select: none;
            user-select: none;
        }
        .nav-btn.active {
            color: #ff5252;
            background: rgba(255, 82, 82, 0.1);
        }
        .nav-btn span:first-child {
            font-size: 20px;
        }
        /* SCROLLBAR */
        .container::-webkit-scrollbar {
            width: 4px;
        }
        .container::-webkit-scrollbar-thumb {
            background: rgba(255, 82, 82, 0.4);
            border-radius: 2px;
        }
        .container::-webkit-scrollbar-track {
            background: transparent;
        }
        /* EMPTY STATE */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #ffcccc;
        }
        .empty-state-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }
        .empty-state-text {
            font-size: 13px;
        }
        /* RECIPE NUTRITION INFO */
        .recipe-nutrition {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-bottom: 8px;
        }
        .nutrition-item {
            background: rgba(255, 82, 82, 0.08);
            padding: 8px;
            border-radius: 6px;
            border: 1px solid rgba(255, 82, 82, 0.2);
            text-align: center;
            font-size: 10px;
        }
        .nutrition-label {
            color: #ff8a80;
            font-weight: 600;
            display: block;
            margin-bottom: 2px;
        }
        .nutrition-value {
            color: #ffebee;
            font-weight: 700;
            font-size: 11px;
        }
        /* INGREDIENT LIST */
        .ingredient-list {
            background: rgba(255, 255, 255, 0.03);
            padding: 8px;
            border-radius: 6px;
            margin-bottom: 8px;
            border-left: 2px solid #ff5252;
        }
        .ingredient-item {
            font-size: 10.5px;
            color: #ffebee;
            padding: 3px 0;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .ingredient-item:before {
            content: "‚úì";
            color: #ff5252;
            font-weight: 700;
        }
        /* STEP LIST */
        .step-list {
            background: rgba(255, 255, 255, 0.03);
            padding: 8px;
            border-radius: 6px;
            margin-bottom: 8px;
            border-left: 2px solid #6495ed;
        }
        .step-item {
            font-size: 10.5px;
            color: #ffebee;
            padding: 4px 0;
            display: flex;
            gap: 6px;
        }
        .step-number {
            background: #6495ed;
            color: #000;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            font-weight: 700;
            flex-shrink: 0;
        }
        .step-content {
            flex: 1;
            line-height: 1.4;
            margin-top: 2px;
        }
    </style>
</head>
<body>
<div class="header">
    <div class="header-left"><span id="temp">--</span>¬∞</div>
    <div class="header-title">BOUAHCHI GOR</div>
    <div class="header-right"><span id="battery">--</span>%</div>
</div>
<div class="container">
    <!-- HOME PAGE -->
    <div class="page active" id="home">
        <div class="launcher">
            <div class="launcher-top">
                <div class="launcher-time" id="time">00:00</div>
                <div class="launcher-date" id="date">Mercredi, 28 Janvier</div>
                <div class="launcher-title">BOUAHCHI GOR</div>
                <div class="launcher-subtitle">La montagne n'attend personne </div>
            </div>
            <div class="launcher-middle">
                <button class="launcher-btn primary" id="btnMaison" onclick="chooseMode('maison')">ENTRA√éNEMENT MAISON</button>
                <button class="launcher-btn primary" id="btnSalle" onclick="chooseMode('salle')">ENTRA√éNEMENT SALLE</button>
                <button class="launcher-btn primary" id="btnNutrition" onclick="goToPage('nutrition')">NUTRITION</button>
                <button class="launcher-btn primary" id="btnNoushi" onclick="goToPage('noushi')">NOUSHI MODE</button>
                <button class="launcher-btn secondary" id="btnRelax" onclick="goToPage('relax')">REPOS & RELAXATION</button>
            </div>
            <div class="launcher-stats">
                <div class="stat">
                    <div>Streak</div>
                    <div class="stat-value" id="statStreak">0</div>
                </div>
                <div class="stat">
                    <div>Repas</div>
                    <div class="stat-value" id="statMeals">0</div>
                </div>
                <div class="stat">
                    <div>Sessions</div>
                    <div class="stat-value" id="statSessions">0</div>
                </div>
            </div>
        </div>
    </div>
    <!-- EXOS PAGE -->
    <div class="page" id="exos">
        <h1 class="section-title">ENTRA√éNEMENT</h1>
        <p class="section-sub" id="exos-sub">Choisis ton programme</p>
        <div class="top-nav" id="mode-nav"></div>
        <input type="text" class="search-box" id="exos-search" placeholder=" Cherche un exercice...">
        <div class="tabs" id="muscle-tabs"></div>
        <div class="grid" id="exos-grid"></div>
    </div>
    <!-- NUTRITION PAGE -->
    <div class="page" id="nutrition">
        <h1 class="section-title">NUTRITION</h1>
        <p class="section-sub">Recettes compl√®tes (2+ mois de vari√©t√©)</p>
        <input type="text" class="search-box" id="recipes-search" placeholder=" Cherche une recette...">
        <div class="tabs" id="meal-tabs"></div>
        <div class="grid" id="recipes-grid"></div>
    </div>
    <!-- NOUSHI PAGE -->
    <div class="page" id="noushi">
        <h1 class="section-title">NOUSHI MODE</h1>
        <p class="section-sub">Les exos les plus extr√™mes (6-12 mois de progression)</p>
        <input type="text" class="search-box" id="noushi-search" placeholder=" Cherche une exo...">
        <div class="tabs" id="noushi-tabs"></div>
        <div class="grid" id="noushi-grid"></div>
    </div>
    <!-- RELAX PAGE -->
    <div class="page" id="relax">
        <h1 class="section-title">RELAXATION</h1>
        <p class="section-sub">R√©cup√©ration compl√®te (yoga, m√©ditation, √©tirement)</p>
        <input type="text" class="search-box" id="relax-search" placeholder=" Cherche une s√©ance...">
        <div class="tabs" id="relax-tabs"></div>
        <div class="grid" id="relax-grid"></div>
    </div>
    <!-- FAVORIS PAGE -->
    <div class="page" id="favoris">
        <h1 class="section-title">MES FAVORIS</h1>
        <p class="section-sub">Tes exos et recettes pr√©f√©r√©es</p>
        <div class="grid" id="favoris-grid"></div>
    </div>
</div>
<div class="nav-bottom">
    <button class="nav-btn active" id="navHome" onclick="goToPage('home')"><span>üè†</span><span>Home</span></button>
    <button class="nav-btn" id="navExos" onclick="goToPage('exos')"><span>üí™</span><span>Exos</span></button>
    <button class="nav-btn" id="navFood" onclick="goToPage('nutrition')"><span>üçΩ</span><span>Food</span></button>
    <button class="nav-btn" id="navNoushi" onclick="goToPage('noushi')"><span>üî•</span><span>Noushi</span></button>
    <button class="nav-btn" id="navRelax" onclick="goToPage('relax')"><span>üßò‚Äç‚ôÇÔ∏è</span><span>Relax</span></button>
    <button class="nav-btn" id="navFavoris" onclick="goToPage('favoris')"><span>‚≠ê</span><span>Favoris</span></button>
</div>

<script>
// ====================== YOUTUBE VIDEOS (inchang√©s) ======================
const YOUTUBE_VIDEOS = {
    'Pompes classiques': 'https://www.youtube.com/embed/y68UkKWkh08',
    'Pompes inclin√©es': 'https://www.youtube.com/embed/rtqbRn5tqrs',
    'Pompes d√©clin√©es': 'https://www.youtube.com/embed/1eccZxpmRsk',
    'Pompes serr√©es': 'https://www.youtube.com/embed/REjGhqa-63E',
    'Pompes explosives': 'https://www.youtube.com/embed/zGmCCtt2R48',
    'Pompes large √©cart': 'https://www.youtube.com/embed/mbdJlPnIhXQ',
    'Dips sur chaise': 'https://www.youtube.com/embed/PjVF-FF8JkU',
    'Curl √©lastique': 'https://www.youtube.com/embed/2KzSMYRXB-8',
    'Pompes triceps mur': 'https://www.youtube.com/embed/6q6OhfP33bk',
    'Dips sol chevilles': 'https://www.youtube.com/embed/bO5zK8AKkI4',
    'Punch en l\'air': 'https://www.youtube.com/embed/fRrQLI8pBLU',
    'Squat poids corps': 'https://www.youtube.com/embed/hNOGNlTKIYg',
    // ... ici, garde toute ta liste d‚ÄôURLs d‚Äôorigine ...
};

// ====================== DATA EXERCICES (extrait, garde ta version compl√®te) ======================
const EXOS = [
    { nom: 'Pompes classiques', pole: 'maison', muscle: 'poitrine', desc: 'Fondamental poids du corps', prep: 'Mains largeur √©paules, corps droit, descendre 2-3cm sol, remonter explosif. 3x10-15 reps.', tips: 'Core engag√©, pas de creusement dos.' },
    { nom: 'Pompes inclin√©es', pole: 'maison', muscle: 'poitrine', desc: 'Pour d√©butants', prep: 'Mains surface √©lev√©e (chaise), m√™me technique. 3x8-12 reps', tips: 'Progression vers pompes normales.' },
    { nom: 'Pompes d√©clin√©es', pole: 'maison', muscle: 'poitrine', desc: 'Pectoraux hauts', prep: 'Pieds sur√©lev√©s, mains sol. 3x6-10 reps', tips: 'Sollicite haut poitrine.' },
    { nom: 'Pompes serr√©es', pole: 'maison', muscle: 'bras', desc: 'Focus triceps', prep: 'Mains rapproch√©es, coudes pr√®s corps. 3x8-12 reps', tips: 'Triceps br√ªlent.' },
    { nom: 'Pompes explosives', pole: 'maison', muscle: 'poitrine', desc: 'Pliom√©trique puissance', prep: 'Pompes rapides, applaudir si possible. 3x5-8 reps.', tips: 'Progresser d\'abord avec normales.' },
    { nom: 'Pompes large √©cart', pole: 'maison', muscle: 'poitrine', desc: 'Pectoraux isolement', prep: 'Mains tr√®s √©cart√©es (1.5x √©paules). 3x10-12 reps', tips: '√âtirement pec maximal.' },
    { nom: 'Dips sur chaise', pole: 'maison', muscle: 'bras', desc: 'Triceps intense', prep: 'Mains chaise derri√®re, pieds devant, plier 90¬∞. 3x8-12 reps', tips: 'Contr√¥ler descente.' },
    // ... garde tout le reste de ton tableau EXOS original ...
];

// ====================== DATA RECETTES / NOUSHI / RELAX (extraits, garde ton contenu original) ======================
const RECIPES = [
    // tes objets recettes, m√™me structure que dans ton fichier
];

const NOUSHI_EXOS = [
    // tes exos noushi complets
];

const RELAX_SESSIONS = [
    // tes s√©ances relax compl√®tes
];

// ====================== STATE GLOBAL ======================
let currentPage = 'home';
let currentMode = 'maison'; // maison / salle
let currentMuscleFilter = 'tous';
let favoris = {
    exos: [],
    recipes: [],
    noushi: [],
    relax: []
};

// ====================== UTILITAIRES ======================
function saveFavoris() {
    try {
        localStorage.setItem('bouahchi_favoris', JSON.stringify(favoris));
    } catch (e) {
        console.warn('Impossible de sauvegarder les favoris', e);
    }
    updateStats();
}

function loadFavoris() {
    try {
        const raw = localStorage.getItem('bouahchi_favoris');
        if (raw) {
            favoris = JSON.parse(raw);
        }
    } catch (e) {
        console.warn('Impossible de charger les favoris', e);
    }
}

function isFavori(type, key) {
    if (!favoris[type]) return false;
    return favoris[type].includes(key);
}

function toggleFavori(type, key) {
    if (!favoris[type]) favoris[type] = [];
    const idx = favoris[type].indexOf(key);
    if (idx === -1) {
        favoris[type].push(key);
    } else {
        favoris[type].splice(idx, 1);
    }
    saveFavoris();
    renderAllPages(); // pour r√©percuter les changements
}

// ====================== STATS ======================
function updateStats() {
    const streakEl = document.getElementById('statStreak');
    const mealsEl = document.getElementById('statMeals');
    const sessionsEl = document.getElementById('statSessions');

    const todayKey = new Date().toISOString().slice(0, 10);
    let history;
    try {
        history = JSON.parse(localStorage.getItem('bouahchi_history') || '{}');
    } catch {
        history = {};
    }

    history[todayKey] = history[todayKey] || { exos: 0, meals: 0 };

    // Streak = nombre de jours cons√©cutifs avec au moins un exo
    let streak = 0;
    let d = new Date();
    while (true) {
        const key = d.toISOString().slice(0, 10);
        const day = history[key];
        if (!day || day.exos === 0) break;
        streak++;
        d.setDate(d.getDate() - 1);
    }

    const totalMeals = Object.values(history).reduce((sum, h) => sum + (h.meals || 0), 0);
    const totalSessions = Object.values(history).reduce((sum, h) => sum + (h.exos || 0), 0);

    streakEl.textContent = streak;
    mealsEl.textContent = totalMeals;
    sessionsEl.textContent = totalSessions;
}

function logSession(type) {
    const todayKey = new Date().toISOString().slice(0, 10);
    let history;
    try {
        history = JSON.parse(localStorage.getItem('bouahchi_history') || '{}');
    } catch {
        history = {};
    }
    history[todayKey] = history[todayKey] || { exos: 0, meals: 0 };
    if (type === 'exo') {
        history[todayKey].exos += 1;
    } else if (type === 'meal') {
        history[todayKey].meals += 1;
    }
    localStorage.setItem('bouahchi_history', JSON.stringify(history));
    updateStats();
}

// ====================== NAVIGATION PAGES ======================
function goToPage(pageId) {
    currentPage = pageId;

    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    const page = document.getElementById(pageId);
    if (page) page.classList.add('active');

    document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
    const navBtn = {
        'home': 'navHome',
        'exos': 'navExos',
        'nutrition': 'navFood',
        'noushi': 'navNoushi',
        'relax': 'navRelax',
        'favoris': 'navFavoris'
    }[pageId];
    if (navBtn) {
        const el = document.getElementById(navBtn);
        if (el) el.classList.add('active');
    }

    // R√©initialiser le scroll pour chaque page
    const container = document.querySelector('.container');
    if (container) container.scrollTop = 0;

    // Rendu contextuel
    if (pageId === 'exos') renderExosPage();
    if (pageId === 'nutrition') renderRecipesPage();
    if (pageId === 'noushi') renderNoushiPage();
    if (pageId === 'relax') renderRelaxPage();
    if (pageId === 'favoris') renderFavorisPage();
}

// pour les boutons ENTRA√éNEMENT MAISON / SALLE
function chooseMode(mode) {
    currentMode = mode;
    const sub = document.getElementById('exos-sub');
    if (sub) {
        sub.textContent = mode === 'maison'
            ? 'Exercices au poids du corps (0 mat√©riel)'
            : 'Exercices complets pour la salle';
    }
    goToPage('exos');
}

// ====================== RENDU EXOS ======================
function getUniqueMusclesForMode(mode) {
    const muscles = new Set();
    EXOS.filter(e => e.pole === mode).forEach(e => muscles.add(e.muscle));
    return ['tous', ...Array.from(muscles)];
}

function renderModeNav() {
    const modeNav = document.getElementById('mode-nav');
    if (!modeNav) return;
    modeNav.innerHTML = '';

    ['maison', 'salle'].forEach(mode => {
        const btn = document.createElement('button');
        btn.className = 'top-nav-btn' + (mode === currentMode ? ' active' : '');
        btn.textContent = mode === 'maison' ? 'MAISON' : 'SALLE';
        btn.onclick = () => {
            currentMode = mode;
            currentMuscleFilter = 'tous';
            renderExosPage();
        };
        modeNav.appendChild(btn);
    });
}

function renderMuscleTabs() {
    const tabs = document.getElementById('muscle-tabs');
    if (!tabs) return;
    tabs.innerHTML = '';

    const muscles = getUniqueMusclesForMode(currentMode);
    muscles.forEach(muscle => {
        const btn = document.createElement('button');
        btn.className = 'tab-btn' + (muscle === currentMuscleFilter ? ' active' : '');
        btn.textContent = muscle === 'tous' ? 'Tous' : muscle.toUpperCase();
        btn.onclick = () => {
            currentMuscleFilter = muscle;
            renderExosGrid();
        };
        tabs.appendChild(btn);
    });
}

function renderExosGrid() {
    const grid = document.getElementById('exos-grid');
    if (!grid) return;
    const search = document.getElementById('exos-search');
    const query = (search?.value || '').toLowerCase();

    let list = EXOS.filter(e => e.pole === currentMode);
    if (currentMuscleFilter !== 'tous') {
        list = list.filter(e => e.muscle === currentMuscleFilter);
    }
    if (query) {
        list = list.filter(e =>
            e.nom.toLowerCase().includes(query) ||
            (e.desc && e.desc.toLowerCase().includes(query))
        );
    }

    grid.innerHTML = '';

    if (list.length === 0) {
        const div = document.createElement('div');
        div.className = 'empty-state';
        div.innerHTML = '<div class="empty-state-icon">üòï</div><div class="empty-state-text">Aucun exercice trouv√©</div>';
        grid.appendChild(div);
        return;
    }

    list.forEach((exo, index) => {
        const card = document.createElement('div');
        card.className = 'card';

        const header = document.createElement('div');
        header.className = 'card-header';

        const title = document.createElement('div');
        title.className = 'card-title';
        title.textContent = exo.nom;

        const favBtn = document.createElement('button');
        favBtn.className = 'card-fav-btn';
        favBtn.innerHTML = isFavori('exos', exo.nom) ? '‚≠ê' : '‚òÜ';
        if (isFavori('exos', exo.nom)) {
            card.classList.add('favorited');
            favBtn.classList.add('active');
        }
        favBtn.onclick = (evt) => {
            evt.stopPropagation();
            toggleFavori('exos', exo.nom);
        };

        header.appendChild(title);
        header.appendChild(favBtn);

        const meta = document.createElement('div');
        meta.className = 'card-meta';
        meta.textContent = exo.muscle.toUpperCase() + ' ‚Ä¢ ' + (exo.pole === 'maison' ? 'Maison' : 'Salle');

        const desc = document.createElement('div');
        desc.className = 'card-text';
        desc.textContent = exo.desc || '';

        const prepSection = document.createElement('div');
        prepSection.className = 'card-section';
        const prepTitle = document.createElement('div');
        prepTitle.className = 'card-section-title';
        prepTitle.textContent = 'Mise en place';
        const prepContent = document.createElement('div');
        prepContent.className = 'card-section-content';
        prepContent.textContent = exo.prep || '';
        prepSection.appendChild(prepTitle);
        prepSection.appendChild(prepContent);

        const tipsSection = document.createElement('div');
        tipsSection.className = 'card-section';
        const tipsTitle = document.createElement('div');
        tipsTitle.className = 'card-section-title';
        tipsTitle.textContent = 'Conseils';
        const tipsContent = document.createElement('div');
        tipsContent.className = 'card-section-content';
        tipsContent.textContent = exo.tips || '';
        tipsSection.appendChild(tipsTitle);
        tipsSection.appendChild(tipsContent);

        card.appendChild(header);
        card.appendChild(meta);
        card.appendChild(desc);
        card.appendChild(prepSection);
        card.appendChild(tipsSection);

        const videoUrl = YOUTUBE_VIDEOS[exo.nom];
        if (videoUrl) {
            const video = document.createElement('div');
            video.className = 'video-container';
            video.innerHTML = `<iframe src="${videoUrl}" allowfullscreen loading="lazy"></iframe>`;
            card.appendChild(video);
        }

        // Navigation dans la liste d'exos (pr√©c√©dent / suivant)
        const nav = document.createElement('div');
        nav.className = 'card-nav';
        const prevBtn = document.createElement('button');
        prevBtn.className = 'nav-btn-prev';
        prevBtn.textContent = '‚óÄ Pr√©c√©dent';
        prevBtn.disabled = index === 0;
        prevBtn.onclick = (e) => {
            e.stopPropagation();
            if (index > 0) {
                const nextCard = grid.children[index - 1];
                nextCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        };

        const nextBtn = document.createElement('button');
        nextBtn.className = 'nav-btn-next';
        nextBtn.textContent = 'Suivant ‚ñ∂';
        nextBtn.disabled = index === list.length - 1;
        nextBtn.onclick = (e) => {
            e.stopPropagation();
            if (index < list.length - 1) {
                const nextCard = grid.children[index + 1];
                nextCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        };

        nav.appendChild(prevBtn);
        nav.appendChild(nextBtn);
        card.appendChild(nav);

        card.onclick = () => {
            logSession('exo');
        };

        grid.appendChild(card);
    });
}

function renderExosPage() {
    renderModeNav();
    renderMuscleTabs();
    renderExosGrid();
}

// ====================== RENDU RECETTES ======================
function renderRecipesTabs() {
    const tabs = document.getElementById('meal-tabs');
    if (!tabs) return;
    tabs.innerHTML = '';

    const types = Array.from(new Set(RECIPES.map(r => r.type || 'autre')));
    ['tous', ...types].forEach(type => {
        const btn = document.createElement('button');
        btn.className = 'tab-btn';
        btn.textContent = type === 'tous' ? 'Tous' : type.toUpperCase();
        btn.onclick = () => {
            renderRecipesGrid(type);
        };
        if (type === 'tous') btn.classList.add('active');
        tabs.appendChild(btn);
    });
}

function renderRecipesGrid(filterType = 'tous') {
    const grid = document.getElementById('recipes-grid');
    if (!grid) return;

    const search = document.getElementById('recipes-search');
    const query = (search?.value || '').toLowerCase();

    let list = RECIPES.slice();
    if (filterType !== 'tous') {
        list = list.filter(r => (r.type || 'autre') === filterType);
    }
    if (query) {
        list = list.filter(r =>
            r.nom.toLowerCase().includes(query) ||
            (r.desc && r.desc.toLowerCase().includes(query))
        );
    }

    grid.innerHTML = '';

    if (list.length === 0) {
        grid.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üçΩ</div><div class="empty-state-text">Aucune recette trouv√©e</div></div>';
        return;
    }

    list.forEach((recette, index) => {
        const card = document.createElement('div');
        card.className = 'card';

        const header = document.createElement('div');
        header.className = 'card-header';

        const title = document.createElement('div');
        title.className = 'card-title';
        title.textContent = recette.nom;

        const favBtn = document.createElement('button');
        favBtn.className = 'card-fav-btn';
        favBtn.innerHTML = isFavori('recipes', recette.nom) ? '‚≠ê' : '‚òÜ';
        if (isFavori('recipes', recette.nom)) {
            card.classList.add('favorited');
            favBtn.classList.add('active');
        }
        favBtn.onclick = (e) => {
            e.stopPropagation();
            toggleFavori('recipes', recette.nom);
        };

        header.appendChild(title);
        header.appendChild(favBtn);

        const meta = document.createElement('div');
        meta.className = 'card-meta';
        meta.textContent = (recette.type || 'Autre').toUpperCase();

        const desc = document.createElement('div');
        desc.className = 'card-text';
        desc.textContent = recette.desc || '';

        card.appendChild(header);
        card.appendChild(meta);
        card.appendChild(desc);

        // Nutrition
        if (recette.nutrition) {
            const nutri = document.createElement('div');
            nutri.className = 'recipe-nutrition';
            Object.entries(recette.nutrition).forEach(([label, val]) => {
                const item = document.createElement('div');
                item.className = 'nutrition-item';
                item.innerHTML = `<span class="nutrition-label">${label}</span><span class="nutrition-value">${val}</span>`;
                nutri.appendChild(item);
            });
            card.appendChild(nutri);
        }

        // Ingredients
        if (recette.ingredients && recette.ingredients.length) {
            const listDiv = document.createElement('div');
            listDiv.className = 'ingredient-list';
            recette.ingredients.forEach(ing => {
                const li = document.createElement('div');
                li.className = 'ingredient-item';
                li.textContent = ing;
                listDiv.appendChild(li);
            });
            card.appendChild(listDiv);
        }

        // √âtapes
        if (recette.etapes && recette.etapes.length) {
            const stepsDiv = document.createElement('div');
            stepsDiv.className = 'step-list';
            recette.etapes.forEach((step, idx) => {
                const s = document.createElement('div');
                s.className = 'step-item';
                s.innerHTML = `<div class="step-number">${idx + 1}</div><div class="step-content">${step}</div>`;
                stepsDiv.appendChild(s);
            });
            card.appendChild(stepsDiv);
        }

        const nav = document.createElement('div');
        nav.className = 'card-nav';
        const prevBtn = document.createElement('button');
        prevBtn.className = 'nav-btn-prev';
        prevBtn.textContent = '‚óÄ Pr√©c√©dent';
        prevBtn.disabled = index === 0;
        prevBtn.onclick = (e) => {
            e.stopPropagation();
            if (index > 0) {
                grid.children[index - 1].scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        };
        const nextBtn = document.createElement('button');
        nextBtn.className = 'nav-btn-next';
        nextBtn.textContent = 'Suivant ‚ñ∂';
        nextBtn.disabled = index === list.length - 1;
        nextBtn.onclick = (e) => {
            e.stopPropagation();
            if (index < list.length - 1) {
                grid.children[index + 1].scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        };
        nav.appendChild(prevBtn);
        nav.appendChild(nextBtn);
        card.appendChild(nav);

        card.onclick = () => logSession('meal');

        grid.appendChild(card);
    });
}

function renderRecipesPage() {
    renderRecipesTabs();
    renderRecipesGrid('tous');
}

// ====================== RENDU NOUSHI ======================
function renderNoushiTabs() {
    const tabs = document.getElementById('noushi-tabs');
    if (!tabs) return;
    tabs.innerHTML = '';

    const niveaux = Array.from(new Set(NOUSHI_EXOS.map(n => n.niveau || 'standard')));
    ['tous', ...niveaux].forEach(level => {
        const btn = document.createElement('button');
        btn.className = 'tab-btn';
        btn.textContent = level === 'tous' ? 'Tous' : level.toUpperCase();
        btn.onclick = () => {
            renderNoushiGrid(level);
        };
        if (level === 'tous') btn.classList.add('active');
        tabs.appendChild(btn);
    });
}

function renderNoushiGrid(filterLevel = 'tous') {
    const grid = document.getElementById('noushi-grid');
    if (!grid) return;

    const search = document.getElementById('noushi-search');
    const query = (search?.value || '').toLowerCase();

    let list = NOUSHI_EXOS.slice();
    if (filterLevel !== 'tous') {
        list = list.filter(e => (e.niveau || 'standard') === filterLevel);
    }
    if (query) {
        list = list.filter(e =>
            e.nom.toLowerCase().includes(query) ||
            (e.desc && e.desc.toLowerCase().includes(query))
        );
    }

    grid.innerHTML = '';

    if (list.length === 0) {
        grid.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üî•</div><div class="empty-state-text">Aucun exo noushi trouv√©</div></div>';
        return;
    }

    list.forEach((exo, index) => {
        const card = document.createElement('div');
        card.className = 'card noushi-card';

        const header = document.createElement('div');
        header.className = 'card-header';

        const title = document.createElement('div');
        title.className = 'card-title';
        title.textContent = exo.nom;

        const favBtn = document.createElement('button');
        favBtn.className = 'card-fav-btn';
        favBtn.innerHTML = isFavori('noushi', exo.nom) ? '‚≠ê' : '‚òÜ';
        if (isFavori('noushi', exo.nom)) {
            card.classList.add('favorited');
            favBtn.classList.add('active');
        }
        favBtn.onclick = (e) => {
            e.stopPropagation();
            toggleFavori('noushi', exo.nom);
        };

        header.appendChild(title);
        header.appendChild(favBtn);

        const meta = document.createElement('div');
        meta.className = 'card-meta';
        meta.textContent = (exo.niveau || 'Standard').toUpperCase();

        const desc = document.createElement('div');
        desc.className = 'card-text';
        desc.textContent = exo.desc || '';

        card.appendChild(header);
        card.appendChild(meta);
        card.appendChild(desc);

        if (exo.prep) {
            const pSection = document.createElement('div');
            pSection.className = 'card-section';
            pSection.innerHTML = '<div class="card-section-title">Pr√©paration</div><div class="card-section-content">' + exo.prep + '</div>';
            card.appendChild(pSection);
        }

        if (exo.tips) {
            const tSection = document.createElement('div');
            tSection.className = 'card-section';
            tSection.innerHTML = '<div class="card-section-title">Conseils</div><div class="card-section-content">' + exo.tips + '</div>';
            card.appendChild(tSection);
        }

        const videoUrl = YOUTUBE_VIDEOS[exo.nom];
        if (videoUrl) {
            const video = document.createElement('div');
            video.className = 'video-container';
            video.innerHTML = `<iframe src="${videoUrl}" allowfullscreen loading="lazy"></iframe>`;
            card.appendChild(video);
        }

        const nav = document.createElement('div');
        nav.className = 'card-nav';
        const prevBtn = document.createElement('button');
        prevBtn.className = 'nav-btn-prev';
        prevBtn.textContent = '‚óÄ Pr√©c√©dent';
        prevBtn.disabled = index === 0;
        prevBtn.onclick = (e) => {
            e.stopPropagation();
            if (index > 0) grid.children[index - 1].scrollIntoView({ behavior: 'smooth', block: 'start' });
        };
        const nextBtn = document.createElement('button');
        nextBtn.className = 'nav-btn-next';
        nextBtn.textContent = 'Suivant ‚ñ∂';
        nextBtn.disabled = index === list.length - 1;
        nextBtn.onclick = (e) => {
            e.stopPropagation();
            if (index < list.length - 1) grid.children[index + 1].scrollIntoView({ behavior: 'smooth', block: 'start' });
        };
        nav.appendChild(prevBtn);
        nav.appendChild(nextBtn);
        card.appendChild(nav);

        card.onclick = () => logSession('exo');

        grid.appendChild(card);
    });
}

function renderNoushiPage() {
    renderNoushiTabs();
    renderNoushiGrid('tous');
}

// ====================== RENDU RELAX ======================
function renderRelaxTabs() {
    const tabs = document.getElementById('relax-tabs');
    if (!tabs) return;
    tabs.innerHTML = '';

    const types = Array.from(new Set(RELAX_SESSIONS.map(r => r.type || 'relax')));
    ['tous', ...types].forEach(type => {
        const btn = document.createElement('button');
        btn.className = 'tab-btn';
        btn.textContent = type === 'tous' ? 'Tous' : type.toUpperCase();
        btn.onclick = () => {
            renderRelaxGrid(type);
        };
        if (type === 'tous') btn.classList.add('active');
        tabs.appendChild(btn);
    });
}

function renderRelaxGrid(filterType = 'tous') {
    const grid = document.getElementById('relax-grid');
    if (!grid) return;

    const search = document.getElementById('relax-search');
    const query = (search?.value || '').toLowerCase();

    let list = RELAX_SESSIONS.slice();
    if (filterType !== 'tous') {
        list = list.filter(r => (r.type || 'relax') === filterType);
    }
    if (query) {
        list = list.filter(r =>
            r.nom.toLowerCase().includes(query) ||
            (r.desc && r.desc.toLowerCase().includes(query))
        );
    }

    grid.innerHTML = '';

    if (list.length === 0) {
        grid.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üßò‚Äç‚ôÇÔ∏è</div><div class="empty-state-text">Aucune s√©ance trouv√©e</div></div>';
        return;
    }

    list.forEach((seance, index) => {
        const card = document.createElement('div');
        card.className = 'card relax-card';

        const header = document.createElement('div');
        header.className = 'card-header';

        const title = document.createElement('div');
        title.className = 'card-title';
        title.textContent = seance.nom;

        const favBtn = document.createElement('button');
        favBtn.className = 'card-fav-btn';
        favBtn.innerHTML = isFavori('relax', seance.nom) ? '‚≠ê' : '‚òÜ';
        if (isFavori('relax', seance.nom)) {
            card.classList.add('favorited');
            favBtn.classList.add('active');
        }
        favBtn.onclick = (e) => {
            e.stopPropagation();
            toggleFavori('relax', seance.nom);
        };

        header.appendChild(title);
        header.appendChild(favBtn);

        const desc = document.createElement('div');
        desc.className = 'card-text';
        desc.textContent = seance.desc || '';

        card.appendChild(header);
        card.appendChild(desc);

        if (seance.steps && seance.steps.length) {
            const stepsDiv = document.createElement('div');
            stepsDiv.className = 'step-list';
            seance.steps.forEach((step, idx) => {
                const s = document.createElement('div');
                s.className = 'step-item';
                s.innerHTML = `<div class="step-number">${idx + 1}</div><div class="step-content">${step}</div>`;
                stepsDiv.appendChild(s);
            });
            card.appendChild(stepsDiv);
        }

        const nav = document.createElement('div');
        nav.className = 'card-nav';
        const prevBtn = document.createElement('button');
        prevBtn.className = 'nav-btn-prev';
        prevBtn.textContent = '‚óÄ Pr√©c√©dent';
        prevBtn.disabled = index === 0;
        prevBtn.onclick = (e) => {
            e.stopPropagation();
            if (index > 0) grid.children[index - 1].scrollIntoView({ behavior: 'smooth', block: 'start' });
        };
        const nextBtn = document.createElement('button');
        nextBtn.className = 'nav-btn-next';
        nextBtn.textContent = 'Suivant ‚ñ∂';
        nextBtn.disabled = index === list.length - 1;
        nextBtn.onclick = (e) => {
            e.stopPropagation();
            if (index < list.length - 1) grid.children[index + 1].scrollIntoView({ behavior: 'smooth', block: 'start' });
        };
        nav.appendChild(prevBtn);
        nav.appendChild(nextBtn);
        card.appendChild(nav);

        grid.appendChild(card);
    });
}

function renderRelaxPage() {
    renderRelaxTabs();
    renderRelaxGrid('tous');
}

// ====================== RENDU FAVORIS ======================
function renderFavorisPage() {
    const grid = document.getElementById('favoris-grid');
    if (!grid) return;
    grid.innerHTML = '';

    const allCards = [];

    EXOS.forEach(exo => {
        if (isFavori('exos', exo.nom)) {
            allCards.push({ type: 'exo', nom: exo.nom, obj: exo });
        }
    });
    RECIPES.forEach(r => {
        if (isFavori('recipes', r.nom)) {
            allCards.push({ type: 'recipe', nom: r.nom, obj: r });
        }
    });
    NOUSHI_EXOS.forEach(e => {
        if (isFavori('noushi', e.nom)) {
            allCards.push({ type: 'noushi', nom: e.nom, obj: e });
        }
    });
    RELAX_SESSIONS.forEach(s => {
        if (isFavori('relax', s.nom)) {
            allCards.push({ type: 'relax', nom: s.nom, obj: s });
        }
    });

    if (allCards.length === 0) {
        grid.innerHTML = '<div class="empty-state"><div class="empty-state-icon">‚≠ê</div><div class="empty-state-text">Aucun favori pour l\'instant. Ajoute en cliquant sur ‚òÜ</div></div>';
        return;
    }

    allCards.forEach(item => {
        const card = document.createElement('div');
        card.className = 'card favorited';

        const header = document.createElement('div');
        header.className = 'card-header';

        const title = document.createElement('div');
        title.className = 'card-title';
        title.textContent = item.nom;

        const favBtn = document.createElement('button');
        favBtn.className = 'card-fav-btn active';
        favBtn.innerHTML = '‚≠ê';
        favBtn.onclick = (e) => {
            e.stopPropagation();
            toggleFavori(
                item.type === 'exo' ? 'exos' :
                item.type === 'recipe' ? 'recipes' :
                item.type === 'noushi' ? 'noushi' : 'relax',
                item.nom
            );
        };

        header.appendChild(title);
        header.appendChild(favBtn);

        const meta = document.createElement('div');
        meta.className = 'card-meta';
        meta.textContent = item.type.toUpperCase();

        card.appendChild(header);
        card.appendChild(meta);

        grid.appendChild(card);
    });
}

// ====================== HORLOGE + DATE ======================
function updateTime() {
    const now = new Date();
    const timeEl = document.getElementById('time');
    const dateEl = document.getElementById('date');
    if (timeEl) {
        const h = String(now.getHours()).padStart(2, '0');
        const m = String(now.getMinutes()).padStart(2, '0');
        timeEl.textContent = `${h}:${m}`;
    }
    if (dateEl) {
        const jours = ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi'];
        const mois = ['Janvier', 'F√©vrier', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Ao√ªt', 'Septembre', 'Octobre', 'Novembre', 'D√©cembre'];
        const j = jours[now.getDay()];
        const d = now.getDate();
        const mo = mois[now.getMonth()];
        dateEl.textContent = `${j}, ${d} ${mo}`;
    }
}

// ====================== BATTERIE & TEMP (placeholder safe) ======================
function initBatteryAndTemp() {
    const batteryEl = document.getElementById('battery');
    const tempEl = document.getElementById('temp');

    if (batteryEl) {
        if (navigator.getBattery) {
            navigator.getBattery().then(b => {
                batteryEl.textContent = Math.round(b.level * 100);
                b.addEventListener('levelchange', () => {
                    batteryEl.textContent = Math.round(b.level * 100);
                });
            }).catch(() => {
                batteryEl.textContent = '--';
            });
        } else {
            batteryEl.textContent = '--';
        }
    }

    if (tempEl) {
        // Sans API m√©t√©o (pour offline), on laisse -- ou une valeur locale si tu veux
        tempEl.textContent = '--';
    }
}

// ====================== RECHERCHE LIVE (events) ======================
function attachSearchListeners() {
    const exosSearch = document.getElementById('exos-search');
    if (exosSearch) {
        exosSearch.addEventListener('input', () => renderExosGrid());
    }
    const recipesSearch = document.getElementById('recipes-search');
    if (recipesSearch) {
        recipesSearch.addEventListener('input', () => renderRecipesGrid('tous'));
    }
    const noushiSearch = document.getElementById('noushi-search');
    if (noushiSearch) {
        noushiSearch.addEventListener('input', () => renderNoushiGrid('tous'));
    }
    const relaxSearch = document.getElementById('relax-search');
    if (relaxSearch) {
        relaxSearch.addEventListener('input', () => renderRelaxGrid('tous'));
    }
}

// ====================== RENDU GLOBAL (quand favoris changent) ======================
function renderAllPages() {
    if (currentPage === 'exos') renderExosPage();
    if (currentPage === 'nutrition') renderRecipesPage();
    if (currentPage === 'noushi') renderNoushiPage();
    if (currentPage === 'relax') renderRelaxPage();
    if (currentPage === 'favoris') renderFavorisPage();
}

// ====================== INITIALISATION ======================
document.addEventListener('DOMContentLoaded', () => {
    loadFavoris();
    updateStats();

    renderExosPage();
    renderRecipesPage();
    renderNoushiPage();
    renderRelaxPage();
    attachSearchListeners();
    renderFavorisPage();

    updateTime();
    setInterval(updateTime, 30000);
    initBatteryAndTemp();
});
</script>
</body>
</html>
